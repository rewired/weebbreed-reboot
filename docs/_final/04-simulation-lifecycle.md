# Simulation Lifecycle [ # Source: docs/system/simulation-engine.md § Timebase & Core Loop (fixed-step, scheduler-agnostic); docs/system/simulation-engine.md § Environment Model (per Zone; well-mixed, delta-based); docs/system/simulation-engine.md § Plant Growth, Stress, Health (per Planting/Plant); docs/system/simulation-engine.md § Tasks & Agentic Employees (utility-based; overtime-aware); docs/system/simulation-engine.md § Economics (currency-neutral) ]

- **Fixed-step scheduler.** Wall-time deltas accumulate until they exceed `tickIntervalMs / gameSpeed`; each loop consumes the budget, runs one full tick, reduces the accumulator, and then publishes committed snapshots and batched events, ensuring deterministic pacing even when catch-up frames occur.【F:docs/system/simulation-engine.md†L12-L25】
- **Environment phase.** Every tick starts from the previous zone state, applies device deltas (lighting heat and PPFD, HVAC cooling/heating, humidity control, CO₂ injection), folds in plant-driven transpiration and photosynthesis, normalises toward ambient with airflow-scaled exponential pull, clamps to safety limits, and emits environmental anomaly events as needed.【F:docs/system/simulation-engine.md†L35-L66】
- **Plant phase.** Phenology advances by tick, resource requirements convert NPK and water curves to per-plant, per-tick demand, stress aggregates weighted penalties across climate and resource drivers, health adjusts via stress thresholds, potential growth factors (light, temperature, CO₂) combine with health to yield actual biomass gains, and quality tracking respects harvest windows.【F:docs/system/simulation-engine.md†L80-L105】
- **Health and workforce phases.** Pests and diseases progress through detect → progress → spread → treat steps with blueprint-driven risk and safety gates, while employees pull tasks by maximising utility functions, execute until `progressTicks ≥ durationTicks`, and accrue overtime per policy when energy dips below zero.【F:docs/system/simulation-engine.md†L115-L170】
- **Accounting phase.** CapEx posts immediately, OpEx aggregates maintenance, energy, and inputs using tick-hour scaling, rent multiplies hourly rates by tick length, labour costs respect overtime policies, and revenue applies quality-modified harvest pricing before finance events are emitted.【F:docs/system/simulation-engine.md†L173-L190】
